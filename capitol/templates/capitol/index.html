{% extends 'base.html' %}

{% load static %}

{% block header_title %}Coding Games{% endblock %}
{% block header_subtitle %}¡Prepárate para demostrar tus habilidades en nuestra competencia anual de programación!{% endblock %}

{% block nav_links %}
    <a href="{% url 'login' %}" class="nav-btn">Ingreso a la Arena</a>
    <a href="{% url 'login_docente' %}" class="nav-btn">Ingreso al Capitolio</a>
{% endblock %}

{% block content %}
    <div class="carousel">
        <div class="carousel-images">
            <img src="{% static 'images/code_camp_1.jpg' %}" alt="Slide 1">
            <img src="{% static 'images/code_camp_4.jpg' %}" alt="Slide 2">
            <img src="{% static 'images/code_camp_3.jpg' %}" alt="Slide 3">
            <img src="{% static 'images/capitol_maker.jpg' %}" alt="Slide 4">
            <!-- Duplicamos las imágenes para loop infinito -->
            <img src="{% static 'images/code_camp_1.jpg' %}" alt="Slide 1">
            <img src="{% static 'images/code_camp_4.jpg' %}" alt="Slide 2">
            <img src="{% static 'images/code_camp_3.jpg' %}" alt="Slide 3">
            <img src="{% static 'images/capitol_maker.jpg' %}" alt="Slide 4">
        </div>
        <button class="carousel-button prev" onclick="prevSlide()">&#10094;</button>
        <button class="carousel-button next" onclick="nextSlide()">&#10095;</button>
    </div>
{% endblock %}

{% block extra_styles %}
    <link rel="stylesheet" href="{% static 'capitol/css/index_styles.css' %}">
    <style>
        /* Elimina scroll en la página de inicio */
        body {
            overflow: hidden;
            height: 100vh;
        }
        main {
            height: calc(100vh - 140px);
            overflow: hidden;
        }

        footer {
            position: fixed;
            bottom: 0;
            width: 100%;
            z-index: 5;
        }
    </style>
{% endblock %}

{% block extra_scripts %}
<script>
    let index = 0;
    const carouselImages = document.querySelector('.carousel-images');
    const slides = document.querySelectorAll('.carousel-images img');
    const totalSlides = slides.length / 2; // La mitad porque están duplicadas
    let isTransitioning = false;

    function moveSlide() {
        if (isTransitioning) return;
        
        isTransitioning = true;
        index++;
        
        const offset = -index * 100;
        carouselImages.style.transition = 'transform 0.5s ease-in-out';
        carouselImages.style.transform = `translateX(${offset}%)`;
        
        // Cuando llegamos al final, reseteamos sin transición
        if (index >= totalSlides) {
            setTimeout(() => {
                carouselImages.style.transition = 'none';
                index = 0;
                carouselImages.style.transform = 'translateX(0%)';
                setTimeout(() => {
                    isTransitioning = false;
                }, 50);
            }, 500);
        } else {
            setTimeout(() => {
                isTransitioning = false;
            }, 500);
        }
    }

    function nextSlide() {
        moveSlide();
    }

    function prevSlide() {
        if (isTransitioning) return;
        
        isTransitioning = true;
        
        if (index === 0) {
            carouselImages.style.transition = 'none';
            index = totalSlides;
            carouselImages.style.transform = `translateX(${-index * 100}%)`;
            
            setTimeout(() => {
                index--;
                carouselImages.style.transition = 'transform 0.5s ease-in-out';
                carouselImages.style.transform = `translateX(${-index * 100}%)`;
                setTimeout(() => {
                    isTransitioning = false;
                }, 500);
            }, 50);
        } else {
            index--;
            carouselImages.style.transform = `translateX(${-index * 100}%)`;
            setTimeout(() => {
                isTransitioning = false;
            }, 500);
        }
    }

    // Auto-advance cada 3 segundos
    setInterval(moveSlide, 3000);
</script>
{% endblock %}
